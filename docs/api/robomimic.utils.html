
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>robomimic.utils package &#8212; robomimic 0.5 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../static/pygments.css" />
    <link rel="stylesheet" href="../static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../static/documentation_options.js"></script>
    <script src="../static/jquery.js"></script>
    <script src="../static/underscore.js"></script>
    <script src="../static/doctools.js"></script>
    <script src="../static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Troubleshooting" href="../miscellaneous/troubleshooting.html" />
    <link rel="prev" title="robomimic.models package" href="robomimic.models.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../static/robomimic_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">robomimic 0.5 documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/implemented_algorithms.html">
   Implemented Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/getting_started.html">
   Getting Started
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Datasets
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets/robomimic_v0.1.html">
   robomimic v0.1 (CoRL 2021)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets/mimicgen.html">
   MimicGen (CoRL 2023)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets/robosuite.html">
   robosuite Datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets/d4rl.html">
   D4RL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets/momart.html">
   MOMART Datasets and Experiments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets/roboturk_pilot.html">
   RoboTurk Pilot
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Pretrained Models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../model_zoo/robomimic_v0.1.html">
   robomimic-v0.1
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/configs.html">
   Configuring and Launching Training Runs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/viewing_results.html">
   Logging and Viewing Training Results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/hyperparam_scan.html">
   Running Hyperparameter Scans
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/reproducing_experiments.html">
   Reproducing Published Experiments and Results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/dataset_contents.html">
   Dataset Contents and Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/multi_dataset_training.html">
   Multi-Dataset Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/training_transformers.html">
   Training Transformers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/training_diffusion_policy.html">
   Training Diffusion Policy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/using_pretrained_models.html">
   Using Pretrained Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/observations.html">
   Multimodal Observations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/action_configs.html">
   Action Configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/language_conditioning.html">
   Language-conditioned Policy Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/pretrained_representations.html">
   Pre-trained Visual Representations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/custom_algorithms.html">
   Implementing Custom Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tensor_collections.html">
   Operations over Tensor Collections
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modules
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../modules/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../modules/dataset.html">
   SequenceDataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../modules/algorithms.html">
   Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../modules/models.html">
   Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../modules/configs.html">
   Configs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../modules/environments.html">
   Environments
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Source API
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="robomimic.html">
   robomimic package
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="robomimic.algo.html">
     robomimic.algo package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="robomimic.config.html">
     robomimic.config package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="robomimic.envs.html">
     robomimic.envs package
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="robomimic.models.html">
     robomimic.models package
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     robomimic.utils package
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../miscellaneous/troubleshooting.html">
   Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../miscellaneous/contributing.html">
   Contributing Guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../miscellaneous/team.html">
   Team
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../miscellaneous/acknowledgments.html">
   Acknowledgments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../miscellaneous/references.html">
   Projects using robomimic
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Previous Versions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../versions/v0.4.html">
   v0.4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../versions/v0.3.html">
   v0.3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../versions/v0.2.html">
   v0.2
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../sources/api/robomimic.utils.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robomimic-utils-dataset-module">
   robomimic.utils.dataset module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.env_utils">
   robomimic.utils.env_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robomimic-utils-file-utils-module">
   robomimic.utils.file_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.hyperparam_utils">
   robomimic.utils.hyperparam_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robomimic-utils-lang-utils-module">
   robomimic.utils.lang_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.log_utils">
   robomimic.utils.log_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.loss_utils">
   robomimic.utils.loss_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.obs_utils">
   robomimic.utils.obs_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.python_utils">
   robomimic.utils.python_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.tensor_utils">
   robomimic.utils.tensor_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robomimic-utils-test-utils-module">
   robomimic.utils.test_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.torch_utils">
   robomimic.utils.torch_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robomimic-utils-train-utils-module">
   robomimic.utils.train_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.vis_utils">
   robomimic.utils.vis_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils">
   Module contents
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>robomimic.utils package</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robomimic-utils-dataset-module">
   robomimic.utils.dataset module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.env_utils">
   robomimic.utils.env_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robomimic-utils-file-utils-module">
   robomimic.utils.file_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.hyperparam_utils">
   robomimic.utils.hyperparam_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robomimic-utils-lang-utils-module">
   robomimic.utils.lang_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.log_utils">
   robomimic.utils.log_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.loss_utils">
   robomimic.utils.loss_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.obs_utils">
   robomimic.utils.obs_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.python_utils">
   robomimic.utils.python_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.tensor_utils">
   robomimic.utils.tensor_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robomimic-utils-test-utils-module">
   robomimic.utils.test_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.torch_utils">
   robomimic.utils.torch_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#robomimic-utils-train-utils-module">
   robomimic.utils.train_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils.vis_utils">
   robomimic.utils.vis_utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-robomimic.utils">
   Module contents
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="robomimic-utils-package">
<h1>robomimic.utils package<a class="headerlink" href="#robomimic-utils-package" title="Permalink to this headline">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">#</a></h2>
</section>
<section id="robomimic-utils-dataset-module">
<h2>robomimic.utils.dataset module<a class="headerlink" href="#robomimic-utils-dataset-module" title="Permalink to this headline">#</a></h2>
</section>
<section id="module-robomimic.utils.env_utils">
<span id="robomimic-utils-env-utils-module"></span><h2>robomimic.utils.env_utils module<a class="headerlink" href="#module-robomimic.utils.env_utils" title="Permalink to this headline">#</a></h2>
<p>This file contains several utility functions for working with environment
wrappers provided by the repository, and with environment metadata saved
in dataset files.</p>
<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.env_utils.check_env_type">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.env_utils.</span></span><span class="sig-name descname"><span class="pre">check_env_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type_to_check</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.env_utils.check_env_type" title="Permalink to this definition">#</a></dt>
<dd><p>Checks whether the passed env_meta, env_type, or env is of type &#64;type_to_check.
Type corresponds to EB.EnvType.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type_to_check</strong> (<em>int</em>) – type to check equality against</p></li>
<li><p><strong>env_meta</strong> (<em>dict</em>) – <p>environment metadata, which should be loaded from demonstration
hdf5 with &#64;FileUtils.get_env_metadata_from_dataset or from checkpoint (see
&#64;FileUtils.env_from_checkpoint). Contains 3 keys:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd"><cite>’env_name’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>name of environment</p>
</dd>
<dt class="field-even"><cite>’type’</cite><span class="colon">:</span></dt>
<dd class="field-even"><p>type of environment, should be a value in EB.EnvType</p>
</dd>
<dt class="field-odd"><cite>’env_kwargs’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of keyword arguments to pass to environment constructor</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>env_type</strong> (<em>int</em>) – the type of environment, which determines the env class that will
be instantiated. Should be a value in EB.EnvType.</p></li>
<li><p><strong>env</strong> (<em>instance of EB.EnvBase</em>) – environment instance</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.env_utils.check_env_version">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.env_utils.</span></span><span class="sig-name descname"><span class="pre">check_env_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_meta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.env_utils.check_env_version" title="Permalink to this definition">#</a></dt>
<dd><p>Checks whether the passed env and env_meta dictionary having matching environment versions.
Logs warning if cannot find version or versions do not match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> (<em>instance of EB.EnvBase</em>) – environment instance</p></li>
<li><p><strong>env_meta</strong> (<em>dict</em>) – <p>environment metadata, which should be loaded from demonstration
hdf5 with &#64;FileUtils.get_env_metadata_from_dataset or from checkpoint (see
&#64;FileUtils.env_from_checkpoint). Contains following key:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd"><cite>’env_version’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>environment version, type str</p>
</dd>
</dl>
</div></blockquote>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.env_utils.create_env">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.env_utils.</span></span><span class="sig-name descname"><span class="pre">create_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_offscreen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_image_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_depth_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.env_utils.create_env" title="Permalink to this definition">#</a></dt>
<dd><p>Create environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_type</strong> (<em>int</em>) – the type of environment, which determines the env class that will
be instantiated. Should be a value in EB.EnvType.</p></li>
<li><p><strong>env_name</strong> (<em>str</em>) – name of environment</p></li>
<li><p><strong>render</strong> (<em>bool</em>) – if True, environment supports on-screen rendering</p></li>
<li><p><strong>render_offscreen</strong> (<em>bool</em>) – if True, environment supports off-screen rendering. This
is forced to be True if &#64;use_image_obs is True.</p></li>
<li><p><strong>use_image_obs</strong> (<em>bool</em>) – if True, environment is expected to render rgb image observations
on every env.step call. Set this to False for efficiency reasons, if image
observations are not required.</p></li>
<li><p><strong>use_depth_obs</strong> (<em>bool</em>) – if True, environment is expected to render depth image observations
on every env.step call. Set this to False for efficiency reasons, if depth
observations are not required.</p></li>
<li><p><strong>lang</strong> – language instruction for the environment</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.env_utils.create_env_for_data_processing">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.env_utils.</span></span><span class="sig-name descname"><span class="pre">create_env_for_data_processing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camera_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camera_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">camera_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_shaping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_offscreen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_image_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_depth_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.env_utils.create_env_for_data_processing" title="Permalink to this definition">#</a></dt>
<dd><p>Creates environment for processing dataset observations and rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_meta</strong> (<em>dict</em>) – <p>environment metadata, which should be loaded from demonstration
hdf5 with &#64;FileUtils.get_env_metadata_from_dataset or from checkpoint (see
&#64;FileUtils.env_from_checkpoint). Contains 3 keys:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd"><cite>’env_name’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>name of environment</p>
</dd>
<dt class="field-even"><cite>’type’</cite><span class="colon">:</span></dt>
<dd class="field-even"><p>type of environment, should be a value in EB.EnvType</p>
</dd>
<dt class="field-odd"><cite>’env_kwargs’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of keyword arguments to pass to environment constructor</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>camera_names</strong> (<em>list of st</em>) – list of camera names that correspond to image observations</p></li>
<li><p><strong>camera_height</strong> (<em>int</em>) – camera height for all cameras</p></li>
<li><p><strong>camera_width</strong> (<em>int</em>) – camera width for all cameras</p></li>
<li><p><strong>reward_shaping</strong> (<em>bool</em>) – if True, use shaped environment rewards, else use sparse task completion rewards</p></li>
<li><p><strong>render</strong> (<em>bool</em><em> or </em><em>None</em>) – optionally override rendering behavior</p></li>
<li><p><strong>render_offscreen</strong> (<em>bool</em><em> or </em><em>None</em>) – optionally override rendering behavior</p></li>
<li><p><strong>use_image_obs</strong> (<em>bool</em><em> or </em><em>None</em>) – optionally override rendering behavior</p></li>
<li><p><strong>use_depth_obs</strong> (<em>bool</em><em> or </em><em>None</em>) – optionally override rendering behavior</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.env_utils.create_env_from_metadata">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.env_utils.</span></span><span class="sig-name descname"><span class="pre">create_env_from_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_offscreen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_image_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_depth_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.env_utils.create_env_from_metadata" title="Permalink to this definition">#</a></dt>
<dd><p>Create environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_meta</strong> (<em>dict</em>) – <p>environment metadata, which should be loaded from demonstration
hdf5 with &#64;FileUtils.get_env_metadata_from_dataset or from checkpoint (see
&#64;FileUtils.env_from_checkpoint). Contains 3 keys:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd"><cite>’env_name’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>name of environment</p>
</dd>
<dt class="field-even"><cite>’type’</cite><span class="colon">:</span></dt>
<dd class="field-even"><p>type of environment, should be a value in EB.EnvType</p>
</dd>
<dt class="field-odd"><cite>’env_kwargs’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of keyword arguments to pass to environment constructor</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>env_name</strong> (<em>str</em>) – name of environment. Only needs to be provided if making a different
environment from the one in &#64;env_meta.</p></li>
<li><p><strong>render</strong> (<em>bool</em>) – if True, environment supports on-screen rendering</p></li>
<li><p><strong>render_offscreen</strong> (<em>bool</em>) – if True, environment supports off-screen rendering. This
is forced to be True if &#64;use_image_obs is True.</p></li>
<li><p><strong>use_image_obs</strong> (<em>bool</em>) – if True, environment is expected to render rgb image observations
on every env.step call. Set this to False for efficiency reasons, if image
observations are not required.</p></li>
<li><p><strong>use_depth_obs</strong> (<em>bool</em>) – if True, environment is expected to render depth image observations
on every env.step call. Set this to False for efficiency reasons, if depth
observations are not required.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.env_utils.get_env_class">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.env_utils.</span></span><span class="sig-name descname"><span class="pre">get_env_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.env_utils.get_env_class" title="Permalink to this definition">#</a></dt>
<dd><p>Return env class from either env_meta, env_type, or env.
Note the use of lazy imports - this ensures that modules are only
imported when the corresponding env type is requested. This can
be useful in practice. For example, a training run that only
requires access to gym environments should not need to import
robosuite.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_meta</strong> (<em>dict</em>) – <p>environment metadata, which should be loaded from demonstration
hdf5 with &#64;FileUtils.get_env_metadata_from_dataset or from checkpoint (see
&#64;FileUtils.env_from_checkpoint). Contains 3 keys:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd"><cite>’env_name’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>name of environment</p>
</dd>
<dt class="field-even"><cite>’type’</cite><span class="colon">:</span></dt>
<dd class="field-even"><p>type of environment, should be a value in EB.EnvType</p>
</dd>
<dt class="field-odd"><cite>’env_kwargs’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of keyword arguments to pass to environment constructor</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>env_type</strong> (<em>int</em>) – the type of environment, which determines the env class that will
be instantiated. Should be a value in EB.EnvType.</p></li>
<li><p><strong>env</strong> (<em>instance of EB.EnvBase</em>) – environment instance</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.env_utils.get_env_type">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.env_utils.</span></span><span class="sig-name descname"><span class="pre">get_env_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.env_utils.get_env_type" title="Permalink to this definition">#</a></dt>
<dd><p>Helper function to get env_type from a variety of inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_meta</strong> (<em>dict</em>) – <p>environment metadata, which should be loaded from demonstration
hdf5 with &#64;FileUtils.get_env_metadata_from_dataset or from checkpoint (see
&#64;FileUtils.env_from_checkpoint). Contains 3 keys:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd"><cite>’env_name’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>name of environment</p>
</dd>
<dt class="field-even"><cite>’type’</cite><span class="colon">:</span></dt>
<dd class="field-even"><p>type of environment, should be a value in EB.EnvType</p>
</dd>
<dt class="field-odd"><cite>’env_kwargs’</cite><span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of keyword arguments to pass to environment constructor</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>env_type</strong> (<em>int</em>) – the type of environment, which determines the env class that will
be instantiated. Should be a value in EB.EnvType.</p></li>
<li><p><strong>env</strong> (<em>instance of EB.EnvBase</em>) – environment instance</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.env_utils.is_robosuite_env">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.env_utils.</span></span><span class="sig-name descname"><span class="pre">is_robosuite_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.env_utils.is_robosuite_env" title="Permalink to this definition">#</a></dt>
<dd><p>Determines whether the environment is a robosuite environment. Accepts
either env_meta, env_type, or env.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.env_utils.set_env_specific_obs_processing">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.env_utils.</span></span><span class="sig-name descname"><span class="pre">set_env_specific_obs_processing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.env_utils.set_env_specific_obs_processing" title="Permalink to this definition">#</a></dt>
<dd><p>Sets env-specific observation processing. As an example, robosuite depth observations
correspond to raw depth and should not be normalized by default, while default depth
processing normalizes and clips all values to [0, 1].</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.env_utils.wrap_env_from_config">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.env_utils.</span></span><span class="sig-name descname"><span class="pre">wrap_env_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.env_utils.wrap_env_from_config" title="Permalink to this definition">#</a></dt>
<dd><p>Wraps environment using the provided Config object to determine which wrappers
to use (if any).</p>
</dd></dl>

</section>
<section id="robomimic-utils-file-utils-module">
<h2>robomimic.utils.file_utils module<a class="headerlink" href="#robomimic-utils-file-utils-module" title="Permalink to this headline">#</a></h2>
</section>
<section id="module-robomimic.utils.hyperparam_utils">
<span id="robomimic-utils-hyperparam-utils-module"></span><h2>robomimic.utils.hyperparam_utils module<a class="headerlink" href="#module-robomimic.utils.hyperparam_utils" title="Permalink to this headline">#</a></h2>
<p>A collection of utility functions and classes for generating config jsons for hyperparameter sweeps.</p>
<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.hyperparam_utils.ConfigGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.hyperparam_utils.</span></span><span class="sig-name descname"><span class="pre">ConfigGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_config_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_exp_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_proj_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">script_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generated_config_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.hyperparam_utils.ConfigGenerator" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Useful class to keep track of hyperparameters to sweep, and to generate
the json configs for each experiment run.</p>
<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.hyperparam_utils.ConfigGenerator.add_param">
<span class="sig-name descname"><span class="pre">add_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.hyperparam_utils.ConfigGenerator.add_param" title="Permalink to this definition">#</a></dt>
<dd><p>Add parameter to the hyperparameter sweep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – location of parameter in the config, using hierarchical key format
(ex. train/data = config.train.data)</p></li>
<li><p><strong>name</strong> (<em>str</em>) – name, as it will appear in the experiment name</p></li>
<li><p><strong>group</strong> (<em>int</em>) – group id - parameters with the same ID have their values swept
together</p></li>
<li><p><strong>values</strong> (<em>list</em>) – list of values to sweep over for this parameter</p></li>
<li><p><strong>value_names</strong> (<em>[</em><em>str</em><em>]</em>) – if provided, strings to use in experiment name for
each value, instead of the parameter value. This is helpful for parameters
that may have long or large values (for example, dataset path).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.hyperparam_utils.ConfigGenerator.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">override_base_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.hyperparam_utils.ConfigGenerator.generate" title="Permalink to this definition">#</a></dt>
<dd><p>Generates json configs for the hyperparameter sweep using attributes
&#64;self.parameters, &#64;self.base_config_file, and &#64;self.script_file,
all of which should have first been set externally by calling
&#64;add_param, &#64;set_base_config_file, and &#64;set_script_file.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.hyperparam_utils.get_value_for_key">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.hyperparam_utils.</span></span><span class="sig-name descname"><span class="pre">get_value_for_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.hyperparam_utils.get_value_for_key" title="Permalink to this definition">#</a></dt>
<dd><p>Get value for nested dictionary with levels denoted by “/” or “.”.
For example, if &#64;k is “a/b”, then this function returns
&#64;dic[“a”][“b”].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dic</strong> (<em>dict</em>) – a nested dictionary</p></li>
<li><p><strong>k</strong> (<em>str</em>) – a single string meant to index several levels down into
the nested dictionary, where levels can be denoted by “/” or
by “.”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the nested dictionary value for the provided key</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>val</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.hyperparam_utils.load_json">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.hyperparam_utils.</span></span><span class="sig-name descname"><span class="pre">load_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.hyperparam_utils.load_json" title="Permalink to this definition">#</a></dt>
<dd><p>Simple utility function to load a json file as a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>json_file</strong> (<em>str</em>) – path to json file to load</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – if True, pretty print the loaded json dictionary</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>json dictionary</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>config (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.hyperparam_utils.save_json">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.hyperparam_utils.</span></span><span class="sig-name descname"><span class="pre">save_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.hyperparam_utils.save_json" title="Permalink to this definition">#</a></dt>
<dd><p>Simple utility function to save a dictionary to a json file on disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>dict</em>) – dictionary to save</p></li>
<li><p><strong>json_file</strong> (<em>str</em>) – path to json file to write</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.hyperparam_utils.set_value_for_key">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.hyperparam_utils.</span></span><span class="sig-name descname"><span class="pre">set_value_for_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.hyperparam_utils.set_value_for_key" title="Permalink to this definition">#</a></dt>
<dd><p>Set value for hierarchical dictionary with levels denoted by “/” or “.”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dic</strong> (<em>dict</em>) – a nested dictionary</p></li>
<li><p><strong>k</strong> (<em>str</em>) – a single string meant to index several levels down into
the nested dictionary, where levels can be denoted by “/” or
by “.”.</p></li>
<li><p><strong>v</strong> – the value to set at the provided key</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="robomimic-utils-lang-utils-module">
<h2>robomimic.utils.lang_utils module<a class="headerlink" href="#robomimic-utils-lang-utils-module" title="Permalink to this headline">#</a></h2>
</section>
<section id="module-robomimic.utils.log_utils">
<span id="robomimic-utils-log-utils-module"></span><h2>robomimic.utils.log_utils module<a class="headerlink" href="#module-robomimic.utils.log_utils" title="Permalink to this headline">#</a></h2>
<p>This file contains utility classes and functions for logging to stdout, stderr,
and to tensorboard.</p>
<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.DataLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">DataLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_tb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_wandb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.DataLogger" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Logging class to log metrics to tensorboard and/or retrieve running statistics about logged data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.DataLogger.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.DataLogger.close" title="Permalink to this definition">#</a></dt>
<dd><p>Run before terminating to make sure all logs are flushed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.DataLogger.get_stats">
<span class="sig-name descname"><span class="pre">get_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.DataLogger.get_stats" title="Permalink to this definition">#</a></dt>
<dd><p>Computes running statistics for a particular key.
:param k: key string
:type k: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of statistics</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>stats (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.DataLogger.record">
<span class="sig-name descname"><span class="pre">record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scalar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.DataLogger.record" title="Permalink to this definition">#</a></dt>
<dd><p>Record data with logger.
:param k: key string
:type k: str
:param v: value to store
:type v: float or image
:param epoch: current epoch number
:param data_type: the type of data. either ‘scalar’ or ‘image’
:type data_type: str
:param log_stats: whether to store the mean/max/min/std for all data logged so far with key k
:type log_stats: bool</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.PrintLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">PrintLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.PrintLogger" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class redirects print statements to both console and a file.</p>
<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.PrintLogger.flush">
<span class="sig-name descname"><span class="pre">flush</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.PrintLogger.flush" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.PrintLogger.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.PrintLogger.write" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.custom_tqdm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">custom_tqdm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.custom_tqdm" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tqdm.std.tqdm</span></code></p>
<p>Small extension to tqdm to make a few changes from default behavior.
By default tqdm writes to stderr. Instead, we change it to write
to stdout.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.flush_warnings">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">flush_warnings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.flush_warnings" title="Permalink to this definition">#</a></dt>
<dd><p>This function flushes all warnings from the global warning buffer to the terminal and
clears the global registry.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.log_warning">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">log_warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'yellow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_now</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.log_warning" title="Permalink to this definition">#</a></dt>
<dd><p>This function logs a warning message by recording it in a global warning buffer.
The global registry will be maintained until &#64;flush_warnings is called, at
which point the warnings will get printed to the terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) – warning message to display</p></li>
<li><p><strong>color</strong> (<em>str</em>) – color of message - defaults to “yellow”</p></li>
<li><p><strong>print_now</strong> (<em>bool</em>) – if True (default), will print to terminal immediately, in
addition to adding it to the global warning buffer</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.log_utils.silence_stdout">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">silence_stdout</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.log_utils.silence_stdout" title="Permalink to this definition">#</a></dt>
<dd><p>This contextmanager will redirect stdout so that nothing is printed
to the terminal. Taken from the link below:</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/6735917/redirecting-stdout-to-nothing-in-python">https://stackoverflow.com/questions/6735917/redirecting-stdout-to-nothing-in-python</a></p>
</dd></dl>

</section>
<section id="module-robomimic.utils.loss_utils">
<span id="robomimic-utils-loss-utils-module"></span><h2>robomimic.utils.loss_utils module<a class="headerlink" href="#module-robomimic.utils.loss_utils" title="Permalink to this headline">#</a></h2>
<p>This file contains a collection of useful loss functions for use with torch tensors.</p>
<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.loss_utils.KLD_0_1_loss">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.loss_utils.</span></span><span class="sig-name descname"><span class="pre">KLD_0_1_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.loss_utils.KLD_0_1_loss" title="Permalink to this definition">#</a></dt>
<dd><p>KL divergence loss. Computes D_KL( N(mu, sigma) || N(0, 1) ). Note that
this function averages across the batch dimension, but sums across dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – mean tensor of shape (B, D)</p></li>
<li><p><strong>logvar</strong> (<em>torch.Tensor</em>) – logvar tensor of shape (B, D)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>KL divergence loss between the input gaussian distribution</dt><dd><p>and N(0, 1)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.loss_utils.KLD_gaussian_loss">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.loss_utils.</span></span><span class="sig-name descname"><span class="pre">KLD_gaussian_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar_2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.loss_utils.KLD_gaussian_loss" title="Permalink to this definition">#</a></dt>
<dd><p>KL divergence loss between two Gaussian distributions. This function
computes the average loss across the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu_1</strong> (<em>torch.Tensor</em>) – first means tensor of shape (B, D)</p></li>
<li><p><strong>logvar_1</strong> (<em>torch.Tensor</em>) – first logvars tensor of shape (B, D)</p></li>
<li><p><strong>mu_2</strong> (<em>torch.Tensor</em>) – second means tensor of shape (B, D)</p></li>
<li><p><strong>logvar_2</strong> (<em>torch.Tensor</em>) – second logvars tensor of shape (B, D)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>KL divergence loss between the two gaussian distributions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.loss_utils.cosine_loss">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.loss_utils.</span></span><span class="sig-name descname"><span class="pre">cosine_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.loss_utils.cosine_loss" title="Permalink to this definition">#</a></dt>
<dd><p>Cosine loss between two tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>torch.Tensor</em>) – torch tensor</p></li>
<li><p><strong>labels</strong> (<em>torch.Tensor</em>) – torch tensor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>cosine loss</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.loss_utils.log_mean_exp">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.loss_utils.</span></span><span class="sig-name descname"><span class="pre">log_mean_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.loss_utils.log_mean_exp" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the log(mean(exp(x), dim)) in a numerically stable manner.
Adapted from CS 236 at Stanford.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – a tensor</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension along which mean is computed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>log(mean(exp(x), dim))</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.loss_utils.log_normal">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.loss_utils.</span></span><span class="sig-name descname"><span class="pre">log_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.loss_utils.log_normal" title="Permalink to this definition">#</a></dt>
<dd><p>Log probability of tensor x under diagonal multivariate normal with
mean m and variance v. The last dimension of the tensors is treated
as the dimension of the Gaussian distribution - all other dimensions
are treated as independent Gaussians. Adapted from CS 236 at Stanford.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – tensor with shape (B, …, D)</p></li>
<li><p><strong>m</strong> (<em>torch.Tensor</em>) – means tensor with shape (B, …, D) or (1, …, D)</p></li>
<li><p><strong>v</strong> (<em>torch.Tensor</em>) – variances tensor with shape (B, …, D) or (1, …, D)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>log probabilities of shape (B, …)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>log_prob (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.loss_utils.log_normal_mixture">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.loss_utils.</span></span><span class="sig-name descname"><span class="pre">log_normal_mixture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.loss_utils.log_normal_mixture" title="Permalink to this definition">#</a></dt>
<dd><p>Log probability of tensor x under a uniform mixture of Gaussians.
Adapted from CS 236 at Stanford.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – tensor with shape (B, D)</p></li>
<li><p><strong>m</strong> (<em>torch.Tensor</em>) – means tensor with shape (B, M, D) or (1, M, D), where
M is number of mixture components</p></li>
<li><p><strong>v</strong> (<em>torch.Tensor</em>) – variances tensor with shape (B, M, D) or (1, M, D) where
M is number of mixture components</p></li>
<li><p><strong>w</strong> (<em>torch.Tensor</em>) – weights tensor - if provided, should be
shape (B, M) or (1, M)</p></li>
<li><p><strong>log_w</strong> (<em>torch.Tensor</em>) – log-weights tensor - if provided, should be
shape (B, M) or (1, M)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>log probabilities of shape (B,)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>log_prob (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.loss_utils.log_sum_exp">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.loss_utils.</span></span><span class="sig-name descname"><span class="pre">log_sum_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.loss_utils.log_sum_exp" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the log(sum(exp(x), dim)) in a numerically stable manner.
Adapted from CS 236 at Stanford.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – a tensor</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension along which sum is computed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>log(sum(exp(x), dim))</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.loss_utils.project_values_onto_atoms">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.loss_utils.</span></span><span class="sig-name descname"><span class="pre">project_values_onto_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probabilities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.loss_utils.project_values_onto_atoms" title="Permalink to this definition">#</a></dt>
<dd><p>Project the categorical distribution given by &#64;probabilities on the
grid of values given by &#64;values onto a grid of values given by &#64;atoms.
This is useful when computing a bellman backup where the backed up
values from the original grid will not be in the original support,
requiring L2 projection.</p>
<p>Each value in &#64;values has a corresponding probability in &#64;probabilities -
this probability mass is shifted to the closest neighboring grid points in
&#64;atoms in proportion. For example, if the value in question is 0.2, and the
neighboring atoms are 0 and 1, then 0.8 of the probability weight goes to
atom 0 and 0.2 of the probability weight will go to 1.</p>
<p>Adapted from <a class="reference external" href="https://github.com/deepmind/acme/blob/master/acme/tf/losses/distributional.py#L42">https://github.com/deepmind/acme/blob/master/acme/tf/losses/distributional.py#L42</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – value grid to project, of shape (batch_size, n_atoms)</p></li>
<li><p><strong>probabilities</strong> – probabilities for categorical distribution on &#64;values, shape (batch_size, n_atoms)</p></li>
<li><p><strong>atoms</strong> – value grid to project onto, of shape (n_atoms,) or (1, n_atoms)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new probability vectors that correspond to the L2 projection of the categorical distribution
onto &#64;atoms</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-robomimic.utils.obs_utils">
<span id="robomimic-utils-obs-utils-module"></span><h2>robomimic.utils.obs_utils module<a class="headerlink" href="#module-robomimic.utils.obs_utils" title="Permalink to this headline">#</a></h2>
<p>A collection of utilities for working with observation dictionaries and
different kinds of modalities such as images.</p>
<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.DepthModality">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">DepthModality</span></span><a class="headerlink" href="#robomimic.utils.obs_utils.DepthModality" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#robomimic.utils.obs_utils.Modality" title="robomimic.utils.obs_utils.Modality"><code class="xref py py-class docutils literal notranslate"><span class="pre">robomimic.utils.obs_utils.Modality</span></code></a></p>
<p>Modality for depth observations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.DepthModality.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'depth'</span></em><a class="headerlink" href="#robomimic.utils.obs_utils.DepthModality.name" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.ImageModality">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">ImageModality</span></span><a class="headerlink" href="#robomimic.utils.obs_utils.ImageModality" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#robomimic.utils.obs_utils.Modality" title="robomimic.utils.obs_utils.Modality"><code class="xref py py-class docutils literal notranslate"><span class="pre">robomimic.utils.obs_utils.Modality</span></code></a></p>
<p>Modality for RGB image observations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.ImageModality.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'rgb'</span></em><a class="headerlink" href="#robomimic.utils.obs_utils.ImageModality.name" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.LowDimModality">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">LowDimModality</span></span><a class="headerlink" href="#robomimic.utils.obs_utils.LowDimModality" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#robomimic.utils.obs_utils.Modality" title="robomimic.utils.obs_utils.Modality"><code class="xref py py-class docutils literal notranslate"><span class="pre">robomimic.utils.obs_utils.Modality</span></code></a></p>
<p>Modality for low dimensional observations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.LowDimModality.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'low_dim'</span></em><a class="headerlink" href="#robomimic.utils.obs_utils.LowDimModality.name" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.Modality">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">Modality</span></span><a class="headerlink" href="#robomimic.utils.obs_utils.Modality" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Observation Modality class to encapsulate necessary functions needed to
process observations of this modality</p>
<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.Modality.add_keys">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.Modality.add_keys" title="Permalink to this definition">#</a></dt>
<dd><p>Adds the observation &#64;keys associated with this modality to the current set of keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>list</em><em> or </em><em>set</em>) – observation keys to add to associate with this modality</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.Modality.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#robomimic.utils.obs_utils.Modality.keys" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.Modality.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#robomimic.utils.obs_utils.Modality.name" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.Modality.process_obs">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">process_obs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.Modality.process_obs" title="Permalink to this definition">#</a></dt>
<dd><p>Prepares an observation &#64;obs of this modality for network input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>np.array</em><em> or </em><em>torch.Tensor</em>) – raw observation, which may include a leading batch dimension</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>processed observation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array or torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.Modality.process_obs_from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">process_obs_from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.Modality.process_obs_from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Receives a dictionary of keyword mapped observations &#64;obs_dict, and processes the observations with keys
corresponding to this modality. A copy will be made of the received dictionary unless &#64;inplace is True</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_dict</strong> (<em>dict</em>) – Dictionary mapping observation keys to observations</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – If True, will modify &#64;obs_dict in place, otherwise, will create a copy</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>observation dictionary with processed observations corresponding to this modality</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.Modality.set_keys">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.Modality.set_keys" title="Permalink to this definition">#</a></dt>
<dd><p>Sets the observation keys associated with this modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>list</em><em> or </em><em>set</em>) – observation keys to associate with this modality</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.Modality.set_obs_processor">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_obs_processor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">processor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.Modality.set_obs_processor" title="Permalink to this definition">#</a></dt>
<dd><p>Sets the processor for this observation modality. If &#64;processor is set to None, then
the obs processor will use the default one (self.process_obs(…)). Otherwise, &#64;processor
should be a function to process this corresponding observation modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>processor</strong> (<em>function</em><em> or </em><em>None</em>) – If not None, should be function that takes in either a
np.array or torch.Tensor and output the processed array / tensor. If None, will reset
to the default processor (self.process_obs(…))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.Modality.set_obs_unprocessor">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_obs_unprocessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unprocessor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.Modality.set_obs_unprocessor" title="Permalink to this definition">#</a></dt>
<dd><p>Sets the unprocessor for this observation modality. If &#64;unprocessor is set to None, then
the obs unprocessor will use the default one (self.unprocess_obs(…)). Otherwise, &#64;unprocessor
should be a function to process this corresponding observation modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>unprocessor</strong> (<em>function</em><em> or </em><em>None</em>) – If not None, should be function that takes in either a
np.array or torch.Tensor and output the unprocessed array / tensor. If None, will reset
to the default unprocessor (self.unprocess_obs(…))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.Modality.unprocess_obs">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unprocess_obs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.Modality.unprocess_obs" title="Permalink to this definition">#</a></dt>
<dd><p>Prepares an observation &#64;obs of this modality for deployment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>np.array</em><em> or </em><em>torch.Tensor</em>) – processed observation, which may include a leading batch dimension</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>unprocessed observation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array or torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.ObservationKeyToModalityDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">ObservationKeyToModalityDict</span></span><a class="headerlink" href="#robomimic.utils.obs_utils.ObservationKeyToModalityDict" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Custom dictionary class with the sole additional purpose of automatically registering new “keys” at runtime
without breaking. This is mainly for backwards compatibility, where certain keys such as “latent”, “actions”, etc.
are used automatically by certain models (e.g.: VAEs) but were never specified by the user externally in their
config. Thus, this dictionary will automatically handle those keys by implicitly associating them with the low_dim
modality.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.ScanModality">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">ScanModality</span></span><a class="headerlink" href="#robomimic.utils.obs_utils.ScanModality" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#robomimic.utils.obs_utils.Modality" title="robomimic.utils.obs_utils.Modality"><code class="xref py py-class docutils literal notranslate"><span class="pre">robomimic.utils.obs_utils.Modality</span></code></a></p>
<p>Modality for scan observations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.ScanModality.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'scan'</span></em><a class="headerlink" href="#robomimic.utils.obs_utils.ScanModality.name" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.batch_image_chw_to_hwc">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">batch_image_chw_to_hwc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.batch_image_chw_to_hwc" title="Permalink to this definition">#</a></dt>
<dd><p>Inverse of channel swap in &#64;batch_image_hwc_to_chw.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>im</strong> (<em>np.array</em><em> or </em><em>torch.Tensor</em>) – image of shape (batch, channel, height, width)
or (channel, height, width)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>image of shape (batch, height, width, channel)</dt><dd><p>or (height, width, channel)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>im (np.array or torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.batch_image_hwc_to_chw">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">batch_image_hwc_to_chw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.batch_image_hwc_to_chw" title="Permalink to this definition">#</a></dt>
<dd><p>Channel swap for images - useful for preparing images for
torch training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>im</strong> (<em>np.array</em><em> or </em><em>torch.Tensor</em>) – image of shape (batch, height, width, channel)
or (height, width, channel)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>image of shape (batch, channel, height, width)</dt><dd><p>or (channel, height, width)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>im (np.array or torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.center_crop">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">center_crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.center_crop" title="Permalink to this definition">#</a></dt>
<dd><p>Takes a center crop of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<em>np.array</em><em> or </em><em>torch.Tensor</em>) – image of shape (…, height, width, channel)</p></li>
<li><p><strong>t_h</strong> (<em>int</em>) – height of crop</p></li>
<li><p><strong>t_w</strong> (<em>int</em>) – width of crop</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>center cropped image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>im (np.array or torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.crop_image_from_indices">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">crop_image_from_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_width</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.crop_image_from_indices" title="Permalink to this definition">#</a></dt>
<dd><p>Crops images at the locations specified by &#64;crop_indices. Crops will be
taken across all channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<em>torch.Tensor</em>) – batch of images of shape […, C, H, W]</p></li>
<li><p><strong>crop_indices</strong> (<em>torch.Tensor</em>) – batch of indices of shape […, N, 2] where
N is the number of crops to take per image and each entry corresponds
to the pixel height and width of where to take the crop. Note that
the indices can also be of shape […, 2] if only 1 crop should
be taken per image. Leading dimensions must be consistent with
&#64;images argument. Each index specifies the top left of the crop.
Values must be in range [0, H - CH - 1] x [0, W - CW - 1] where
H and W are the height and width of &#64;images and CH and CW are
&#64;crop_height and &#64;crop_width.</p></li>
<li><p><strong>crop_height</strong> (<em>int</em>) – height of crop to take</p></li>
<li><p><strong>crop_width</strong> (<em>int</em>) – width of crop to take</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>cropped images of shape […, C, &#64;crop_height, &#64;crop_width]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>crops (torch.Tesnor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.get_processed_shape">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">get_processed_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_modality</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.get_processed_shape" title="Permalink to this definition">#</a></dt>
<dd><p>Given observation modality &#64;obs_modality and expected inputs of shape &#64;input_shape (excluding batch dimension), return the
expected processed observation shape resulting from process_{obs_modality}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_modality</strong> (<em>str</em>) – Observation modality to use (e.g.: low_dim, rgb, depth, etc…)</p></li>
<li><p><strong>input_shape</strong> (<em>list of int</em>) – Expected input dimensions, excluding the batch dimension</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>expected processed input shape</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.has_modality">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">has_modality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modality</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_keys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.has_modality" title="Permalink to this definition">#</a></dt>
<dd><p>Returns True if &#64;modality is present in the list of observation keys &#64;obs_keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modality</strong> (<em>str</em>) – modality to check for, e.g.: rgb, depth, etc.</p></li>
<li><p><strong>obs_keys</strong> (<em>list</em>) – list of observation keys</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.initialize_default_obs_encoder">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">initialize_default_obs_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_encoder_config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.initialize_default_obs_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes the default observation encoder kwarg information to be used by all networks if no values are manually
specified at runtime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs_encoder_config</strong> (<a class="reference internal" href="robomimic.config.html#robomimic.config.config.Config" title="robomimic.config.config.Config"><em>Config</em></a>) – Observation encoder config to use.
Should be equivalent to config.observation.encoder</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.initialize_obs_modality_mapping_from_dict">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">initialize_obs_modality_mapping_from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modality_mapping</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.initialize_obs_modality_mapping_from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>This function is an alternative to &#64;initialize_obs_utils_with_obs_specs, that allows manually setting of modalities.
NOTE: Only one of these should be called at runtime – not both! (Note that all training scripts that use a config)</p>
<blockquote>
<div><p>automatically handle obs modality mapping, so using this function is usually unnecessary)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>modality_mapping</strong> (<em>dict</em>) – Maps modality string names (e.g.: rgb, low_dim, etc.) to a list of observation
keys that should belong to that modality</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.initialize_obs_utils_with_config">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">initialize_obs_utils_with_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.initialize_obs_utils_with_config" title="Permalink to this definition">#</a></dt>
<dd><p>Utility function to parse config and call &#64;initialize_obs_utils_with_obs_specs and
&#64;initialize_default_obs_encoder_kwargs with the correct arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>BaseConfig instance</em>) – config object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.initialize_obs_utils_with_obs_specs">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">initialize_obs_utils_with_obs_specs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_modality_specs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.initialize_obs_utils_with_obs_specs" title="Permalink to this definition">#</a></dt>
<dd><p>This function should be called before using any observation key-specific
functions in this file, in order to make sure that all utility
functions are aware of the observation modalities (e.g. which ones
are low-dimensional, which ones are rgb, etc.).</p>
<p>It constructs two dictionaries: (1) that map observation modality (e.g. low_dim, rgb) to
a list of observation keys under that modality, and (2) that maps the inverse, specific
observation keys to their corresponding observation modality.</p>
<p>Input should be a nested dictionary (or list of such dicts) with the following structure:</p>
<blockquote>
<div><dl class="simple">
<dt>obs_variant (str):</dt><dd><p>obs_modality (str): observation keys (list)
…</p>
</dd>
</dl>
<p>…</p>
</div></blockquote>
<p class="rubric">Example</p>
<dl>
<dt>{</dt><dd><dl class="simple">
<dt>“obs”: {</dt><dd><p>“low_dim”: [“robot0_eef_pos”, “robot0_eef_quat”],
“rgb”: [“agentview_image”, “robot0_eye_in_hand”],</p>
</dd>
</dl>
<p>}
“goal”: {</p>
<blockquote>
<div><p>“low_dim”: [“robot0_eef_pos”],
“rgb”: [“agentview_image”]</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>
<p>In the example, raw observations consist of low-dim and rgb modalities, with
the robot end effector pose under low-dim, and the agentview and wrist camera
images under rgb, while goal observations also consist of low-dim and rgb modalities,
with a subset of the raw observation keys per modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs_modality_specs</strong> (<em>dict</em><em> or </em><em>list</em>) – A nested dictionary (see docstring above for an example)
or a list of nested dictionaries. Accepting a list as input makes it convenient for
situations where multiple modules may each have their own modality spec.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.key_is_obs_modality">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">key_is_obs_modality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_modality</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.key_is_obs_modality" title="Permalink to this definition">#</a></dt>
<dd><p>Check if observation key corresponds to modality &#64;obs_modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – obs key name to check</p></li>
<li><p><strong>obs_modality</strong> (<em>str</em>) – observation modality - e.g.: “low_dim”, “rgb”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.normalize_dict">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">normalize_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_stats</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.normalize_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Normalize dict using the provided “offset” and “scale” entries
for each observation key. The dictionary will be
modified in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dict</strong> (<em>dict</em>) – dictionary mapping key to np.array or
torch.Tensor. Leading batch dimensions are optional.</p></li>
<li><p><strong>normalization_stats</strong> (<em>dict</em>) – this should map keys to dicts
with a “offset” and “scale” of shape (1, …) where … is the default
shape for the dict value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>obs dict with normalized arrays</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.obs_encoder_kwargs_from_config">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">obs_encoder_kwargs_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_encoder_config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.obs_encoder_kwargs_from_config" title="Permalink to this definition">#</a></dt>
<dd><p>Generate a set of args used to create visual backbones for networks
from the observation encoder config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs_encoder_config</strong> (<a class="reference internal" href="robomimic.config.html#robomimic.config.config.Config" title="robomimic.config.config.Config"><em>Config</em></a>) – Config object containing relevant encoder information. Should be equivalent to
config.observation.encoder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed encoder kwargs</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.process_frame">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">process_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.process_frame" title="Permalink to this definition">#</a></dt>
<dd><p>Given frame fetched from dataset, process for network input. Converts array
to float (from uint8), normalizes pixels from range [0, &#64;scale] to [0, 1], and channel swaps
from (H, W, C) to (C, H, W).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>np.array</em><em> or </em><em>torch.Tensor</em>) – frame array</p></li>
<li><p><strong>channel_dim</strong> (<em>int</em>) – Number of channels to sanity check for</p></li>
<li><p><strong>scale</strong> (<em>float</em><em> or </em><em>None</em>) – Value to normalize inputs by</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>processed frame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>processed_frame (np.array or torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.process_obs">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">process_obs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_modality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.process_obs" title="Permalink to this definition">#</a></dt>
<dd><p>Process observation &#64;obs corresponding to &#64;obs_modality modality (or implicitly inferred from &#64;obs_key)
to prepare for network input.</p>
<p>Note that either obs_modality OR obs_key must be specified!</p>
<p>If both are specified, obs_key will override obs_modality</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>np.array</em><em> or </em><em>torch.Tensor</em>) – Observation to process. Leading batch dimension is optional</p></li>
<li><p><strong>obs_modality</strong> (<em>str</em>) – Observation modality (e.g.: depth, image, low_dim, etc.)</p></li>
<li><p><strong>obs_key</strong> (<em>str</em>) – Name of observation from which to infer &#64;obs_modality</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>processed observation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>processed_obs (np.array or torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.process_obs_dict">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">process_obs_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.process_obs_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Process observations in observation dictionary to prepare for network input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs_dict</strong> (<em>dict</em>) – dictionary mapping observation keys to np.array or
torch.Tensor. Leading batch dimensions are optional.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary where observation keys have been processed by their corresponding processors</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>new_dict (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.register_encoder_backbone">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">register_encoder_backbone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_class</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.register_encoder_backbone" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.register_encoder_core">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">register_encoder_core</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_class</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.register_encoder_core" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.register_obs_key">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">register_obs_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_class</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.register_obs_key" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.register_randomizer">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">register_randomizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_class</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.register_randomizer" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.repeat_and_stack_observation">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">repeat_and_stack_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.repeat_and_stack_observation" title="Permalink to this definition">#</a></dt>
<dd><p>Given an observation dictionary and a desired repeat value &#64;n,
this function will return a new observation dictionary where
each modality is repeated &#64;n times and the copies are
stacked in the first dimension.</p>
<p>For example, if a batch of 3 observations comes in, and n is 2,
the output will look like [ob1; ob1; ob2; ob2; ob3; ob3] in
each modality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_dict</strong> (<em>dict</em>) – dictionary mapping observation key to np.array or
torch.Tensor. Leading batch dimensions are optional.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number to repeat by</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>repeated obs dict</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>repeat_obs_dict (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.sample_random_image_crops">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">sample_random_image_crops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_crops</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_enc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.sample_random_image_crops" title="Permalink to this definition">#</a></dt>
<dd><p>For each image, randomly sample &#64;num_crops crops of size (&#64;crop_height, &#64;crop_width), from
&#64;images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<em>torch.Tensor</em>) – batch of images of shape […, C, H, W]</p></li>
<li><p><strong>crop_height</strong> (<em>int</em>) – height of crop to take</p></li>
<li><p><strong>crop_width</strong> (<em>int</em>) – width of crop to take</p></li>
<li><p><strong>num_crops</strong> (<em>n</em>) – number of crops to sample</p></li>
<li><p><strong>pos_enc</strong> (<em>bool</em>) – if True, also add 2 channels to the outputs that gives a spatial
encoding of the original source pixel locations. This means that the
output crops will contain information about where in the source image
it was sampled from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>crops of shape (…, &#64;num_crops, C, &#64;crop_height, &#64;crop_width)</dt><dd><p>if &#64;pos_enc is False, otherwise (…, &#64;num_crops, C + 2, &#64;crop_height, &#64;crop_width)</p>
</dd>
</dl>
<p>crop_inds (torch.Tensor): sampled crop indices of shape (…, N, 2)</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>crops (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.unnormalize_dict">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">unnormalize_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_stats</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.unnormalize_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Unnormalize dict using the provided “offset” and “scale” entries
for each observation key. The dictionary will be
modified in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dict</strong> (<em>dict</em>) – dictionary mapping key to np.array or
torch.Tensor. Leading batch dimensions are optional.</p></li>
<li><p><strong>normalization_stats</strong> (<em>dict</em>) – this should map keys to dicts
with a “offset” and “scale” of shape (1, …) where … is the default
shape for the dict value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>obs dict with normalized arrays</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.unprocess_frame">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">unprocess_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.unprocess_frame" title="Permalink to this definition">#</a></dt>
<dd><p>Given frame prepared for network input, prepare for saving to dataset.
Inverse of &#64;process_frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>np.array</em><em> or </em><em>torch.Tensor</em>) – frame array</p></li>
<li><p><strong>channel_dim</strong> (<em>int</em>) – What channel dimension should be (used for sanity check)</p></li>
<li><p><strong>scale</strong> (<em>float</em><em> or </em><em>None</em>) – Scaling factor to apply during denormalization</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>frame passed through</dt><dd><p>inverse operation of &#64;process_frame</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>unprocessed_frame (np.array or torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.unprocess_obs">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">unprocess_obs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_modality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.unprocess_obs" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare observation &#64;obs corresponding to &#64;obs_modality modality (or implicitly inferred from &#64;obs_key)
to prepare for deployment.</p>
<p>Note that either obs_modality OR obs_key must be specified!</p>
<p>If both are specified, obs_key will override obs_modality</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>np.array</em><em> or </em><em>torch.Tensor</em>) – Observation to unprocess. Leading batch dimension is optional</p></li>
<li><p><strong>obs_modality</strong> (<em>str</em>) – Observation modality (e.g.: depth, image, low_dim, etc.)</p></li>
<li><p><strong>obs_key</strong> (<em>str</em>) – Name of observation from which to infer &#64;obs_modality</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>unprocessed observation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>unprocessed_obs (np.array or torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.obs_utils.unprocess_obs_dict">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.obs_utils.</span></span><span class="sig-name descname"><span class="pre">unprocess_obs_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.obs_utils.unprocess_obs_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare processed observation dictionary for saving to dataset. Inverse of
&#64;process_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs_dict</strong> (<em>dict</em>) – dictionary mapping observation keys to np.array or
torch.Tensor. Leading batch dimensions are optional.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>dictionary where observation keys have been unprocessed by</dt><dd><p>their respective unprocessor methods</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>new_dict (dict)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-robomimic.utils.python_utils">
<span id="robomimic-utils-python-utils-module"></span><h2>robomimic.utils.python_utils module<a class="headerlink" href="#module-robomimic.utils.python_utils" title="Permalink to this headline">#</a></h2>
<p>Set of general purpose utility functions for easier interfacing with Python API</p>
<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.python_utils.action_dict_to_vector">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.python_utils.</span></span><span class="sig-name descname"><span class="pre">action_dict_to_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#robomimic.utils.python_utils.action_dict_to_vector" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.python_utils.deep_update">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.python_utils.</span></span><span class="sig-name descname"><span class="pre">deep_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.python_utils.deep_update" title="Permalink to this definition">#</a></dt>
<dd><p>Deeply update dictionary &#64;d with values from dictionary &#64;u.</p>
<p>Copied from <a class="reference external" href="https://stackoverflow.com/a/3233356">https://stackoverflow.com/a/3233356</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.python_utils.extract_class_init_kwargs_from_dict">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.python_utils.</span></span><span class="sig-name descname"><span class="pre">extract_class_init_kwargs_from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.python_utils.extract_class_init_kwargs_from_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Helper function to return a dictionary of key-values that specifically correspond to &#64;cls class’s __init__
constructor method, from &#64;dic which may or may not contain additional, irrelevant kwargs.</p>
<p>Note that &#64;dic may possibly be missing certain kwargs as specified by cls.__init__. No error will be raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<em>object</em>) – Class from which to grab __init__ kwargs that will be be used as filtering keys for &#64;dic</p></li>
<li><p><strong>dic</strong> (<em>dict</em>) – Dictionary containing multiple key-values</p></li>
<li><p><strong>copy</strong> (<em>bool</em>) – If True, will deepcopy all values corresponding to the specified &#64;keys</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True (or if macro DEBUG is True), then will print out mismatched keys</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Extracted subset dictionary possibly containing only the specified keys from cls.__init__ and their</dt><dd><p>corresponding values</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.python_utils.extract_subset_dict">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.python_utils.</span></span><span class="sig-name descname"><span class="pre">extract_subset_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.python_utils.extract_subset_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Helper function to extract a subset of dictionary key-values from a current dictionary. Optionally (deep)copies
the values extracted from the original &#64;dic if &#64;copy is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dic</strong> (<em>dict</em>) – Dictionary containing multiple key-values</p></li>
<li><p><strong>keys</strong> (<em>Iterable</em>) – Specific keys to extract from &#64;dic. If the key doesn’t exist in &#64;dic, then the key is skipped</p></li>
<li><p><strong>copy</strong> (<em>bool</em>) – If True, will deepcopy all values corresponding to the specified &#64;keys</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extracted subset dictionary containing only the specified &#64;keys and their corresponding values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.python_utils.get_class_init_kwargs">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.python_utils.</span></span><span class="sig-name descname"><span class="pre">get_class_init_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.python_utils.get_class_init_kwargs" title="Permalink to this definition">#</a></dt>
<dd><p>Helper function to return a list of all valid keyword arguments (excluding “self”) for the given &#64;cls class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cls</strong> (<em>object</em>) – Class from which to grab __init__ kwargs</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All keyword arguments (excluding “self”) specified by &#64;cls __init__ constructor method</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.python_utils.vector_to_action_dict">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.python_utils.</span></span><span class="sig-name descname"><span class="pre">vector_to_action_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#robomimic.utils.python_utils.vector_to_action_dict" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-robomimic.utils.tensor_utils">
<span id="robomimic-utils-tensor-utils-module"></span><h2>robomimic.utils.tensor_utils module<a class="headerlink" href="#module-robomimic.utils.tensor_utils" title="Permalink to this headline">#</a></h2>
<p>A collection of utilities for working with nested tensor structures consisting
of numpy arrays and torch tensors.</p>
<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.assert_size_at_dim">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">assert_size_at_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.assert_size_at_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Ensure that arrays and tensors in nested dictionary or list or tuple have
size &#64;size in dim &#64;dim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>size</strong> (<em>int</em>) – size that tensors should have at &#64;dim</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension to check</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.assert_size_at_dim_single">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">assert_size_at_dim_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.assert_size_at_dim_single" title="Permalink to this definition">#</a></dt>
<dd><p>Ensure that array or tensor &#64;x has size &#64;size in dim &#64;dim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em><em> or </em><em>torch.Tensor</em>) – input array or tensor</p></li>
<li><p><strong>size</strong> (<em>int</em>) – size that tensors should have at &#64;dim</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension to check</p></li>
<li><p><strong>msg</strong> (<em>str</em>) – text to display if assertion fails</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.clone">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.clone" title="Permalink to this definition">#</a></dt>
<dd><p>Clones all torch tensors and numpy arrays in nested dictionary or list
or tuple and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.contiguous">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">contiguous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.contiguous" title="Permalink to this definition">#</a></dt>
<dd><p>Makes all torch tensors and numpy arrays contiguous in nested dictionary or
list or tuple and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.detach">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.detach" title="Permalink to this definition">#</a></dt>
<dd><p>Detaches all torch tensors in nested dictionary or list
or tuple and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.expand_at">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">expand_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.expand_at" title="Permalink to this definition">#</a></dt>
<dd><p>Expand all tensors in nested dictionary or list or tuple at a single
dimension &#64;dim by &#64;size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>size</strong> (<em>int</em>) – size to expand</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension to expand</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.expand_at_single">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">expand_at_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.expand_at_single" title="Permalink to this definition">#</a></dt>
<dd><p>Expand a tensor at a single dimension &#64;dim by &#64;size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – input tensor</p></li>
<li><p><strong>size</strong> (<em>int</em>) – size to expand</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension to expand</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>expanded tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.flatten">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.flatten" title="Permalink to this definition">#</a></dt>
<dd><p>Flatten all tensors in nested dictionary or list or tuple, from &#64;begin_axis onwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>begin_axis</strong> (<em>int</em>) – which axis to flatten from</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.flatten_nested_dict_list">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">flatten_nested_dict_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.flatten_nested_dict_list" title="Permalink to this definition">#</a></dt>
<dd><p>Flatten a nested dict or list to a list.</p>
<p>For example, given a dict
{</p>
<blockquote>
<div><p>a: 1
b: {</p>
<blockquote>
<div><p>c: 2</p>
</div></blockquote>
<p>}
c: 3</p>
</div></blockquote>
<p>}</p>
<p>the function would return [(a, 1), (b_c, 2), (c, 3)]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>dict</em><em>, </em><em>list</em>) – a nested dict or list to be flattened</p></li>
<li><p><strong>parent_key</strong> (<em>str</em>) – recursion helper</p></li>
<li><p><strong>sep</strong> (<em>str</em>) – separator for nesting keys</p></li>
<li><p><strong>item_key</strong> (<em>str</em>) – recursion helper</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of (key, value) tuples</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.flatten_single">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">flatten_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.flatten_single" title="Permalink to this definition">#</a></dt>
<dd><p>Flatten a tensor in all dimensions from &#64;begin_axis onwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – tensor to flatten</p></li>
<li><p><strong>begin_axis</strong> (<em>int</em>) – which axis to flatten from</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>flattened tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.gather_along_dim_with_dim">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">gather_along_dim_with_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.gather_along_dim_with_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Apply &#64;gather_along_dim_with_dim_single to all tensors in a nested
dictionary or list or tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>target_dim</strong> (<em>int</em>) – dimension to gather values along</p></li>
<li><p><strong>source_dim</strong> (<em>int</em>) – dimension to hold constant and use for gathering values
from the other dimensions</p></li>
<li><p><strong>indices</strong> (<em>torch.Tensor</em>) – flat index tensor with same shape as tensor &#64;x along
&#64;source_dim</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.gather_along_dim_with_dim_single">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">gather_along_dim_with_dim_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.gather_along_dim_with_dim_single" title="Permalink to this definition">#</a></dt>
<dd><p>This function indexes out a target dimension of a tensor in a structured way,
by allowing a different value to be selected for each member of a flat index
tensor (&#64;indices) corresponding to a source dimension. This can be interpreted
as moving along the source dimension, using the corresponding index value
in &#64;indices to select values for all other dimensions outside of the
source and target dimensions. A common use case is to gather values
in target dimension 1 for each batch member (target dimension 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – tensor to gather values for</p></li>
<li><p><strong>target_dim</strong> (<em>int</em>) – dimension to gather values along</p></li>
<li><p><strong>source_dim</strong> (<em>int</em>) – dimension to hold constant and use for gathering values
from the other dimensions</p></li>
<li><p><strong>indices</strong> (<em>torch.Tensor</em>) – flat index tensor with same shape as tensor &#64;x along
&#64;source_dim</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>gathered tensor, with dimension &#64;target_dim indexed out</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.gather_sequence">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">gather_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.gather_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Given a nested dictionary or list or tuple, gathers an element from each sequence of the batch
for tensors with leading dimensions [B, T, …].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple with tensors
of leading dimensions [B, T, …]</p></li>
<li><p><strong>indices</strong> (<em>torch.Tensor</em>) – tensor indices of shape [B]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple with tensors of shape [B, …]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.gather_sequence_single">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">gather_sequence_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.gather_sequence_single" title="Permalink to this definition">#</a></dt>
<dd><p>Given a tensor with leading dimensions [B, T, …], gather an element from each sequence in
the batch given an index for each sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq</strong> (<em>torch.Tensor</em>) – tensor with leading dimensions [B, T, …]</p></li>
<li><p><strong>indices</strong> (<em>torch.Tensor</em>) – tensor indices of shape [B]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>indexed tensor of shape [B, ….]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.get_shape">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">get_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.get_shape" title="Permalink to this definition">#</a></dt>
<dd><p>Get all shapes of arrays and tensors in nested dictionary or list or tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>new nested dict-list-tuple that contains each array or</dt><dd><p>tensor’s shape</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.index_at_time">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">index_at_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.index_at_time" title="Permalink to this definition">#</a></dt>
<dd><p>Indexes all torch tensors and numpy arrays in dimension 1 with index &#64;ind in
nested dictionary or list or tuple and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>ind</strong> (<em>int</em>) – index</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.join_dimensions">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">join_dimensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_axis</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.join_dimensions" title="Permalink to this definition">#</a></dt>
<dd><p>Joins all dimensions between dimensions (&#64;begin_axis, &#64;end_axis) into a flat dimension, for
all tensors in nested dictionary or list or tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>begin_axis</strong> (<em>int</em>) – begin dimension</p></li>
<li><p><strong>end_axis</strong> (<em>int</em>) – end dimension</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.list_of_flat_dict_to_dict_of_list">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">list_of_flat_dict_to_dict_of_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_of_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.list_of_flat_dict_to_dict_of_list" title="Permalink to this definition">#</a></dt>
<dd><p>Helper function to go from a list of flat dictionaries to a dictionary of lists.
By “flat” we mean that none of the values are dictionaries, but are numpy arrays,
floats, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>list_of_dict</strong> (<em>list</em>) – list of flat dictionaries</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary of lists</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict_of_list (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.map_ndarray">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">map_ndarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.map_ndarray" title="Permalink to this definition">#</a></dt>
<dd><p>Apply function &#64;func to np.ndarray objects in a nested dictionary or
list or tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>func</strong> (<em>function</em>) – function to apply to each array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.map_tensor">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">map_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.map_tensor" title="Permalink to this definition">#</a></dt>
<dd><p>Apply function &#64;func to torch.Tensor objects in a nested dictionary or
list or tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>func</strong> (<em>function</em>) – function to apply to each tensor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.map_tensor_ndarray">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">map_tensor_ndarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndarray_func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.map_tensor_ndarray" title="Permalink to this definition">#</a></dt>
<dd><p>Apply function &#64;tensor_func to torch.Tensor objects and &#64;ndarray_func to
np.ndarray objects in a nested dictionary or list or tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>tensor_func</strong> (<em>function</em>) – function to apply to each tensor</p></li>
<li><p><strong>ndarray_Func</strong> (<em>function</em>) – function to apply to each array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.named_reduce">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">named_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.named_reduce" title="Permalink to this definition">#</a></dt>
<dd><p>Reduces all tensors in nested dictionary or list or tuple at a dimension
using a named reduction function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>reduction</strong> (<em>str</em>) – one of [“sum”, “max”, “mean”, “flatten”]</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension to be reduced (or begin axis for flatten)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.named_reduce_single">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">named_reduce_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.named_reduce_single" title="Permalink to this definition">#</a></dt>
<dd><p>Reduce tensor at a dimension by named reduction functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – tensor to be reduced</p></li>
<li><p><strong>reduction</strong> (<em>str</em>) – one of [“sum”, “max”, “mean”, “flatten”]</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension to be reduced (or begin axis for flatten)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reduced tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.pad_sequence">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">pad_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batched</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_same</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.pad_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Pad a nested dictionary or list or tuple of sequence tensors in the time dimension (dimension 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple with tensors
of leading dimensions [B, T, …]</p></li>
<li><p><strong>padding</strong> (<em>tuple</em>) – begin and end padding, e.g. [1, 1] pads both begin and end of the sequence by 1</p></li>
<li><p><strong>batched</strong> (<em>bool</em>) – if sequence has the batch dimension</p></li>
<li><p><strong>pad_same</strong> (<em>bool</em>) – if pad by duplicating</p></li>
<li><p><strong>pad_values</strong> (<em>scalar</em><em> or </em><em>(</em><em>ndarray</em><em>, </em><em>Tensor</em><em>)</em>) – values to be padded if not pad_same</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>padded sequence (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.pad_sequence_single">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">pad_sequence_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batched</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_same</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.pad_sequence_single" title="Permalink to this definition">#</a></dt>
<dd><p>Pad input tensor or array &#64;seq in the time dimension (dimension 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq</strong> (<em>np.ndarray</em><em> or </em><em>torch.Tensor</em>) – sequence to be padded</p></li>
<li><p><strong>padding</strong> (<em>tuple</em>) – begin and end padding, e.g. [1, 1] pads both begin and end of the sequence by 1</p></li>
<li><p><strong>batched</strong> (<em>bool</em>) – if sequence has the batch dimension</p></li>
<li><p><strong>pad_same</strong> (<em>bool</em>) – if pad by duplicating</p></li>
<li><p><strong>pad_values</strong> (<em>scalar</em><em> or </em><em>(</em><em>ndarray</em><em>, </em><em>Tensor</em><em>)</em>) – values to be padded if not pad_same</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>padded sequence (np.ndarray or torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.recursive_dict_list_tuple_apply">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">recursive_dict_list_tuple_apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_func_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.recursive_dict_list_tuple_apply" title="Permalink to this definition">#</a></dt>
<dd><p>Recursively apply functions to a nested dictionary or list or tuple, given a dictionary of
{data_type: function_to_apply}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>type_func_dict</strong> (<em>dict</em>) – a mapping from data types to the functions to be
applied for each data type.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.repeat_by_expand_at">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">repeat_by_expand_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.repeat_by_expand_at" title="Permalink to this definition">#</a></dt>
<dd><p>Repeat a dimension by combining expand and reshape operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>repeats</strong> (<em>int</em>) – number of times to repeat the target dimension</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension to repeat on</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.reshape_dimensions">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">reshape_dimensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dims</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.reshape_dimensions" title="Permalink to this definition">#</a></dt>
<dd><p>Reshape selected dimensions for all tensors in nested dictionary or list or tuple
to a target dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>begin_axis</strong> (<em>int</em>) – begin dimension</p></li>
<li><p><strong>end_axis</strong> (<em>int</em>) – end dimension (inclusive)</p></li>
<li><p><strong>target_dims</strong> (<em>tuple</em><em> or </em><em>list</em>) – target shape for the range of dimensions
(&#64;begin_axis, &#64;end_axis)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.reshape_dimensions_single">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">reshape_dimensions_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dims</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.reshape_dimensions_single" title="Permalink to this definition">#</a></dt>
<dd><p>Reshape selected dimensions in a tensor to a target dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – tensor to reshape</p></li>
<li><p><strong>begin_axis</strong> (<em>int</em>) – begin dimension</p></li>
<li><p><strong>end_axis</strong> (<em>int</em>) – end dimension (inclusive)</p></li>
<li><p><strong>target_dims</strong> (<em>tuple</em><em> or </em><em>list</em>) – target shape for the range of dimensions
(&#64;begin_axis, &#64;end_axis)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reshaped tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.time_distributed">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">time_distributed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs_as_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs_as_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.time_distributed" title="Permalink to this definition">#</a></dt>
<dd><p>Apply function &#64;op to all tensors in nested dictionary or list or tuple &#64;inputs in both the
batch (B) and time (T) dimension, where the tensors are expected to have shape [B, T, …].
Will do this by reshaping tensors to [B * T, …], passing through the op, and then reshaping
outputs to [B, T, …].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>dict</em>) – a possibly nested dictionary or list or tuple with tensors
of leading dimensions [B, T, …]</p></li>
<li><p><strong>op</strong> – a layer op that accepts inputs</p></li>
<li><p><strong>activation</strong> – activation to apply at the output</p></li>
<li><p><strong>inputs_as_kwargs</strong> (<em>bool</em>) – whether to feed input as a kwargs dict to the op</p></li>
<li><p><strong>inputs_as_args</strong> (<em>bool</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – other kwargs to supply to the op</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple with tensors of leading dimension [B, T].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>outputs (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_batch">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_batch" title="Permalink to this definition">#</a></dt>
<dd><p>Introduces a leading batch dimension of 1 for all torch tensors and numpy
arrays in nested dictionary or list or tuple and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_device">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_device" title="Permalink to this definition">#</a></dt>
<dd><p>Sends all torch tensors in nested dictionary or list or tuple to device
&#64;device, and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>device</strong> (<em>torch.Device</em>) – device to send tensors to</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_float">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_float" title="Permalink to this definition">#</a></dt>
<dd><p>Converts all torch tensors and numpy arrays in nested dictionary or list
or tuple to float type entries, and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_list">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_list" title="Permalink to this definition">#</a></dt>
<dd><p>Converts all torch tensors and numpy arrays in nested dictionary or list
or tuple to a list, and returns a new nested structure. Useful for
json encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_numpy">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_numpy" title="Permalink to this definition">#</a></dt>
<dd><p>Converts all torch tensors in nested dictionary or list or tuple to
numpy (and leaves existing numpy arrays as-is), and returns
a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_one_hot">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_one_hot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_class</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_one_hot" title="Permalink to this definition">#</a></dt>
<dd><p>Convert all tensors in nested dictionary or list or tuple to one-hot representation,
assuming a certain number of total class labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>num_class</strong> (<em>int</em>) – number of classes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_one_hot_single">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_one_hot_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_class</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_one_hot_single" title="Permalink to this definition">#</a></dt>
<dd><p>Convert tensor to one-hot representation, assuming a certain number of total class labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<em>torch.Tensor</em>) – tensor containing integer labels</p></li>
<li><p><strong>num_class</strong> (<em>int</em>) – number of classes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tensor containing one-hot representation of labels</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>x (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_sequence">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Introduces a time dimension of 1 at dimension 1 for all torch tensors and numpy
arrays in nested dictionary or list or tuple and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_tensor">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_tensor" title="Permalink to this definition">#</a></dt>
<dd><p>Converts all numpy arrays in nested dictionary or list or tuple to
torch tensors (and leaves existing torch Tensors as-is), and returns
a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_torch">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_torch" title="Permalink to this definition">#</a></dt>
<dd><p>Converts all numpy arrays and torch tensors in nested dictionary or list or tuple to
torch tensors on device &#64;device and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>device</strong> (<em>torch.Device</em>) – device to send tensors to</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.to_uint8">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">to_uint8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.to_uint8" title="Permalink to this definition">#</a></dt>
<dd><p>Converts all torch tensors and numpy arrays in nested dictionary or list
or tuple to uint8 type entries, and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.unsqueeze">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.unsqueeze" title="Permalink to this definition">#</a></dt>
<dd><p>Adds dimension of size 1 at dimension &#64;dim in all torch tensors and numpy arrays
in nested dictionary or list or tuple and returns a new nested structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.tensor_utils.unsqueeze_expand_at">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">unsqueeze_expand_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.tensor_utils.unsqueeze_expand_at" title="Permalink to this definition">#</a></dt>
<dd><p>Unsqueeze and expand a tensor at a dimension &#64;dim by &#64;size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>dict</em><em> or </em><em>list</em><em> or </em><em>tuple</em>) – a possibly nested dictionary or list or tuple</p></li>
<li><p><strong>size</strong> (<em>int</em>) – size to expand</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension to unsqueeze and expand</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new nested dict-list-tuple</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y (dict or list or tuple)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="robomimic-utils-test-utils-module">
<h2>robomimic.utils.test_utils module<a class="headerlink" href="#robomimic-utils-test-utils-module" title="Permalink to this headline">#</a></h2>
</section>
<section id="module-robomimic.utils.torch_utils">
<span id="robomimic-utils-torch-utils-module"></span><h2>robomimic.utils.torch_utils module<a class="headerlink" href="#module-robomimic.utils.torch_utils" title="Permalink to this headline">#</a></h2>
<p>This file contains some PyTorch utilities.</p>
<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.axis_angle_to_matrix">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">axis_angle_to_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#robomimic.utils.torch_utils.axis_angle_to_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Convert rotations given as axis/angle to rotation matrices.
:param axis_angle: Rotations given as a vector in axis angle form,</p>
<blockquote>
<div><p>as a tensor of shape (…, 3), where the magnitude is
the angle turned anticlockwise in radians around the
vector’s direction.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Rotation matrices as tensor of shape (…, 3, 3).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.axis_angle_to_quaternion">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">axis_angle_to_quaternion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#robomimic.utils.torch_utils.axis_angle_to_quaternion" title="Permalink to this definition">#</a></dt>
<dd><p>Convert rotations given as axis/angle to quaternions.
:param axis_angle: Rotations given as a vector in axis angle form,</p>
<blockquote>
<div><p>as a tensor of shape (…, 3), where the magnitude is
the angle turned anticlockwise in radians around the
vector’s direction.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>quaternions with real part first, as tensor of shape (…, 4).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.axis_angle_to_rot_6d">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">axis_angle_to_rot_6d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.axis_angle_to_rot_6d" title="Permalink to this definition">#</a></dt>
<dd><p>Converts tensor with rot_6d representation to axis-angle representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.backprop_for_loss">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">backprop_for_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.backprop_for_loss" title="Permalink to this definition">#</a></dt>
<dd><p>Backpropagate loss and update parameters for network with
name &#64;name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>net</strong> (<em>torch.nn.Module</em>) – network to update</p></li>
<li><p><strong>optim</strong> (<em>torch.optim.Optimizer</em>) – optimizer to use</p></li>
<li><p><strong>loss</strong> (<em>torch.Tensor</em>) – loss to use for backpropagation</p></li>
<li><p><strong>max_grad_norm</strong> (<em>float</em>) – if provided, used to clip gradients</p></li>
<li><p><strong>retain_graph</strong> (<em>bool</em>) – if True, graph is not freed after backward call</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>average gradient norms from backpropagation</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>grad_norms (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.dummy_context_mgr">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">dummy_context_mgr</span></span><a class="headerlink" href="#robomimic.utils.torch_utils.dummy_context_mgr" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A dummy context manager - useful for having conditional scopes (such
as &#64;maybe_no_grad). Nothing happens in this scope.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.euler_angles_to_matrix">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">euler_angles_to_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">euler_angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convention</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#robomimic.utils.torch_utils.euler_angles_to_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Convert rotations given as Euler angles in radians to rotation matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>euler_angles</strong> – Euler angles in radians as tensor of shape (…, 3).</p></li>
<li><p><strong>convention</strong> – Convention string of three uppercase letters from
{“X”, “Y”, and “Z”}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rotation matrices as tensor of shape (…, 3, 3).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.euler_angles_to_rot_6d">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">euler_angles_to_rot_6d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">euler_angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'XYZ'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.euler_angles_to_rot_6d" title="Permalink to this definition">#</a></dt>
<dd><p>Converts tensor with rot_6d representation to euler representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.get_state_dict">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">get_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.get_state_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a state dict for an input of objects. This is useful for
saving the state of of networks, optimizers, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>dict</em><em>, </em><em>list</em><em>, </em><em>torch.Module</em>) – input to convert to state dict</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>state dict with keys as the names of the objects</dt><dd><p>in the input and values as their state dicts</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>state_dict (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.get_torch_device">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">get_torch_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">try_to_use_cuda</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.get_torch_device" title="Permalink to this definition">#</a></dt>
<dd><p>Return torch device. If using cuda (GPU), will also set cudnn.benchmark to True
to optimize CNNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>try_to_use_cuda</strong> (<em>bool</em>) – if True and cuda is available, will use GPU</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>device to use for models</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>device (torch.Device)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.hard_update">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">hard_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.hard_update" title="Permalink to this definition">#</a></dt>
<dd><p>Hard update &#64;target parameters to match &#64;source.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>torch.nn.Module</em>) – source network to provide parameters</p></li>
<li><p><strong>target</strong> (<em>torch.nn.Module</em>) – target network to update parameters for</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.load_state_dict">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">load_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.load_state_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a state dict for an input of objects. This is useful for
saving the state of of networks, optimizers, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<em>dict</em><em>, </em><em>list</em><em>, </em><em>torch.Module</em>) – input to load state dict into</p></li>
<li><p><strong>state_dict</strong> (<em>dict</em>) – state dict with keys as the names of the objects</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.lr_scheduler_from_optim_params">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">lr_scheduler_from_optim_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net_optim_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.lr_scheduler_from_optim_params" title="Permalink to this definition">#</a></dt>
<dd><p>Helper function to return a LRScheduler from the optim_params
section of the config for a particular network. Returns None
if a scheduler is not needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optim_params</strong> (<a class="reference internal" href="robomimic.config.html#robomimic.config.config.Config" title="robomimic.config.config.Config"><em>Config</em></a>) – optim_params part of algo_config corresponding
to &#64;net. This determines whether a learning rate scheduler is created.</p></li>
<li><p><strong>net</strong> (<em>torch.nn.Module</em>) – module whose parameters this optimizer will be
responsible</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – optimizer for this net</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>learning rate scheduler</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lr_scheduler (torch.optim.lr_scheduler or None)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.matrix_to_axis_angle">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">matrix_to_axis_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#robomimic.utils.torch_utils.matrix_to_axis_angle" title="Permalink to this definition">#</a></dt>
<dd><p>Convert rotations given as rotation matrices to axis/angle.
:param matrix: Rotation matrices as tensor of shape (…, 3, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Rotations given as a vector in axis angle form, as a tensor</dt><dd><p>of shape (…, 3), where the magnitude is the angle
turned anticlockwise in radians around the vector’s
direction.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.matrix_to_euler_angles">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">matrix_to_euler_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convention</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#robomimic.utils.torch_utils.matrix_to_euler_angles" title="Permalink to this definition">#</a></dt>
<dd><p>Convert rotations given as rotation matrices to Euler angles in radians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> – Rotation matrices as tensor of shape (…, 3, 3).</p></li>
<li><p><strong>convention</strong> – Convention string of three uppercase letters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Euler angles in radians as tensor of shape (…, 3).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.matrix_to_quaternion">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">matrix_to_quaternion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#robomimic.utils.torch_utils.matrix_to_quaternion" title="Permalink to this definition">#</a></dt>
<dd><p>Convert rotations given as rotation matrices to quaternions.
:param matrix: Rotation matrices as tensor of shape (…, 3, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>quaternions with real part first, as tensor of shape (…, 4).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.matrix_to_rotation_6d">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">matrix_to_rotation_6d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#robomimic.utils.torch_utils.matrix_to_rotation_6d" title="Permalink to this definition">#</a></dt>
<dd><p>Converts rotation matrices to 6D rotation representation by Zhou et al. [1]
by dropping the last row. Note that 6D representation is not unique.
:param matrix: batch of rotation matrices of size (<a href="#id1"><span class="problematic" id="id2">*</span></a>, 3, 3)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>6D rotation representation, of size (<a href="#id3"><span class="problematic" id="id4">*</span></a>, 6)</p>
</dd>
</dl>
<p>[1] Zhou, Y., Barnes, C., Lu, J., Yang, J., &amp; Li, H.
On the Continuity of Rotation Representations in Neural Networks.
IEEE Conference on Computer Vision and Pattern Recognition, 2019.
Retrieved from <a class="reference external" href="http://arxiv.org/abs/1812.07035">http://arxiv.org/abs/1812.07035</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.maybe_no_grad">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">maybe_no_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_grad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.maybe_no_grad" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>no_grad</strong> (<em>bool</em>) – if True, the returned context will be torch.no_grad(), otherwise
it will be a dummy context</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.optimizer_from_optim_params">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">optimizer_from_optim_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net_optim_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">net</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.optimizer_from_optim_params" title="Permalink to this definition">#</a></dt>
<dd><p>Helper function to return a torch Optimizer from the optim_params
section of the config for a particular network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optim_params</strong> (<a class="reference internal" href="robomimic.config.html#robomimic.config.config.Config" title="robomimic.config.config.Config"><em>Config</em></a>) – optim_params part of algo_config corresponding
to &#64;net. This determines the optimizer that is created.</p></li>
<li><p><strong>net</strong> (<em>torch.nn.Module</em>) – module whose parameters this optimizer will be
responsible</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>optimizer</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optimizer (torch.optim.Optimizer)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.quaternion_to_axis_angle">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">quaternion_to_axis_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quaternions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#robomimic.utils.torch_utils.quaternion_to_axis_angle" title="Permalink to this definition">#</a></dt>
<dd><p>Convert rotations given as quaternions to axis/angle.
:param quaternions: quaternions with real part first,</p>
<blockquote>
<div><p>as tensor of shape (…, 4).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Rotations given as a vector in axis angle form, as a tensor</dt><dd><p>of shape (…, 3), where the magnitude is the angle
turned anticlockwise in radians around the vector’s
direction.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.quaternion_to_matrix">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">quaternion_to_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quaternions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#robomimic.utils.torch_utils.quaternion_to_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Convert rotations given as quaternions to rotation matrices.
:param quaternions: quaternions with real part first,</p>
<blockquote>
<div><p>as tensor of shape (…, 4).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Rotation matrices as tensor of shape (…, 3, 3).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.reparameterize">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">reparameterize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.reparameterize" title="Permalink to this definition">#</a></dt>
<dd><p>Reparameterize for the backpropagation of z instead of q.
This makes it so that we can backpropagate through the sampling of z from
our encoder when feeding the sampled variable to the decoder.</p>
<p>(See “The reparameterization trick” section of <a class="reference external" href="https://arxiv.org/abs/1312.6114">https://arxiv.org/abs/1312.6114</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – batch of means from the encoder distribution</p></li>
<li><p><strong>logvar</strong> (<em>torch.Tensor</em>) – batch of log variances from the encoder distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>batch of sampled latents from the encoder distribution that</dt><dd><p>support backpropagation</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>z (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.rot_6d_to_axis_angle">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">rot_6d_to_axis_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rot_6d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.rot_6d_to_axis_angle" title="Permalink to this definition">#</a></dt>
<dd><p>Converts tensor with rot_6d representation to axis-angle representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.rot_6d_to_euler_angles">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">rot_6d_to_euler_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rot_6d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'XYZ'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.rot_6d_to_euler_angles" title="Permalink to this definition">#</a></dt>
<dd><p>Converts tensor with rot_6d representation to euler representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.rotation_6d_to_matrix">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">rotation_6d_to_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d6</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#robomimic.utils.torch_utils.rotation_6d_to_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Converts 6D rotation representation by Zhou et al. [1] to rotation matrix
using Gram–Schmidt orthogonalization per Section B of [1].
:param d6: 6D rotation representation, of size (<a href="#id5"><span class="problematic" id="id6">*</span></a>, 6)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>batch of rotation matrices of size (<a href="#id7"><span class="problematic" id="id8">*</span></a>, 3, 3)</p>
</dd>
</dl>
<p>[1] Zhou, Y., Barnes, C., Lu, J., Yang, J., &amp; Li, H.
On the Continuity of Rotation Representations in Neural Networks.
IEEE Conference on Computer Vision and Pattern Recognition, 2019.
Retrieved from <a class="reference external" href="http://arxiv.org/abs/1812.07035">http://arxiv.org/abs/1812.07035</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.torch_utils.soft_update">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.torch_utils.</span></span><span class="sig-name descname"><span class="pre">soft_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.torch_utils.soft_update" title="Permalink to this definition">#</a></dt>
<dd><p>Soft update from the parameters of a &#64;source torch module to a &#64;target torch module
with strength &#64;tau. The update follows target = target * (1 - tau) + source * tau.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>torch.nn.Module</em>) – source network to push target network parameters towards</p></li>
<li><p><strong>target</strong> (<em>torch.nn.Module</em>) – target network to update</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="robomimic-utils-train-utils-module">
<h2>robomimic.utils.train_utils module<a class="headerlink" href="#robomimic-utils-train-utils-module" title="Permalink to this headline">#</a></h2>
</section>
<section id="module-robomimic.utils.vis_utils">
<span id="robomimic-utils-vis-utils-module"></span><h2>robomimic.utils.vis_utils module<a class="headerlink" href="#module-robomimic.utils.vis_utils" title="Permalink to this headline">#</a></h2>
<p>This file contains utility functions for visualizing image observations in the training pipeline.
These functions can be a useful debugging tool.</p>
<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.vis_utils.depth_to_rgb">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.vis_utils.</span></span><span class="sig-name descname"><span class="pre">depth_to_rgb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depth_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.vis_utils.depth_to_rgb" title="Permalink to this definition">#</a></dt>
<dd><p>Convert depth map to rgb array by computing normalized depth values in [0, 1].</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.vis_utils.image_tensor_to_disk">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.vis_utils.</span></span><span class="sig-name descname"><span class="pre">image_tensor_to_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.vis_utils.image_tensor_to_disk" title="Permalink to this definition">#</a></dt>
<dd><p>Writes an image tensor to disk. Any leading batch dimensions are indexed out
with the first element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em>) – image of shape […, C, H, W]. All leading dimensions
will be indexed out with the first element</p></li>
<li><p><strong>fname</strong> (<em>str</em>) – path to save image to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.vis_utils.image_tensor_to_numpy">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.vis_utils.</span></span><span class="sig-name descname"><span class="pre">image_tensor_to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.vis_utils.image_tensor_to_numpy" title="Permalink to this definition">#</a></dt>
<dd><p>Converts processed image tensors to numpy so that they can be saved to disk or video.
A useful utility function for visualizing images in the middle of training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>image</strong> (<em>torch.Tensor</em>) – images of shape […, C, H, W]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>converted images of shape […, H, W, C] and type uint8</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>image (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.vis_utils.image_to_disk">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.vis_utils.</span></span><span class="sig-name descname"><span class="pre">image_to_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.vis_utils.image_to_disk" title="Permalink to this definition">#</a></dt>
<dd><p>Writes an image to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.array</em>) – image of shape [H, W, 3]</p></li>
<li><p><strong>fname</strong> (<em>str</em>) – path to save image to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="robomimic.utils.vis_utils.visualize_image_randomizer">
<span class="sig-prename descclassname"><span class="pre">robomimic.utils.vis_utils.</span></span><span class="sig-name descname"><span class="pre">visualize_image_randomizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomized_image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomizer_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#robomimic.utils.vis_utils.visualize_image_randomizer" title="Permalink to this definition">#</a></dt>
<dd><p>A function that visualizes the before and after of an image-based input randomizer
:param original_image: batch of original image shaped [B, H, W, 3]
:param randomized_image: randomized image shaped [B, N, H, W, 3]. N is the number of randomization per input sample
:param randomizer_name: (Optional) name of the randomizer</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-robomimic.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-robomimic.utils" title="Permalink to this headline">#</a></h2>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="robomimic.models.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">robomimic.models package</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../miscellaneous/troubleshooting.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Troubleshooting</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By the robomimic core team<br/>
  
      &copy; Copyright the robomimic core team, 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>